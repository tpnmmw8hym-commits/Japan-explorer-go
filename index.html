<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Japan Explorer Pro â€¢ @Muchan_official â€¢ 1000+ Food â€¢ PokÃ©mon â€¢ Matcha Spots</title>
    <meta name="description" content="Japan's most complete interactive map by @Muchan_official - 1000+ food spots, PokÃ©mon Centers, matcha ceremonies, mochi workshops, and hidden gems.">
    <meta name="keywords" content="Japan travel, PokÃ©mon Center, matcha, mochi workshop, Tokyo food, Kyoto, Osaka, TeamLab, Muchan_official, TikTok Japan">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== ROOT VARIABLES ========== */
        :root {
            --primary-red: #e60012; /* Japan red */
            --primary-red-light: #ff5252;
            --dark-bg: #0f172a;
            --darker-bg: #0a0f1f;
            --card-bg: #1e293b;
            --text-light: #f8fafc;
            --text-gray: #94a3b8;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-blue: #3b82f6;
            --accent-pink: #ec4899;
            --accent-cyan: #06b6d4;
            --accent-orange: #f97316;
            --radius: 16px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--dark-bg);
            color: var(--text-light);
            overflow: hidden;
            touch-action: pan-y;
        }

        /* ========== HEADER ========== */
        .header {
            background: linear-gradient(135deg, var(--darker-bg) 0%, #1a1f3a 100%);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--primary-red);
            height: 70px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex: 1;
        }

        .logo {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--primary-red-light) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }

        .header-text h1 {
            font-size: 1.1rem;
            background: linear-gradient(90deg, #fff, var(--primary-red-light));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.1rem;
            line-height: 1.2;
        }

        .header-text p {
            color: var(--text-gray);
            font-size: 0.75rem;
            display: none;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .tiktok-badge, .youtube-badge {
            background: #000;
            color: white;
            padding: 0.5rem 0.8rem;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            text-decoration: none;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .youtube-badge {
            background: #ff0000;
        }

        .tiktok-badge:hover, .youtube-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .donate-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            border: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
        }

        .donate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .language-selector {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: var(--text-light);
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            cursor: pointer;
            outline: none;
        }

        /* ========== MAIN LAYOUT ========== */
        .app-container {
            height: 100vh;
            padding-top: 70px;
            display: flex;
        }

        /* ========== SIDEBAR (PC) ========== */
        .sidebar {
            width: 400px;
            background: var(--darker-bg);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            display: none; /* Hidden on mobile by default */
        }

        .sidebar.active {
            display: flex;
        }

        .sidebar-header {
            padding: 1.2rem;
            background: var(--card-bg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .search-container {
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 3rem;
            background: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .search-icon {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-gray);
        }

        /* ========== ADVANCED FILTERS ========== */
        .filters-section {
            padding: 1.2rem;
            background: var(--card-bg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .filters-section h3 {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-bottom: 1rem;
        }

        .filter-btn {
            padding: 0.6rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-gray);
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .filter-btn:hover {
            background: rgba(230, 0, 18, 0.1);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
        }

        .filter-btn.active {
            background: rgba(230, 0, 18, 0.2);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
            font-weight: 600;
        }

        .region-select {
            width: 100%;
            padding: 0.8rem;
            background: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .filter-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 0.5rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.7rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .action-btn.primary {
            background: var(--primary-red);
            color: white;
        }

        .action-btn.secondary {
            background: transparent;
            border: 1px solid var(--text-gray);
            color: var(--text-gray);
        }

        /* ========== PLACES LIST ========== */
        .places-list {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 1rem;
        }

        .places-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            position: sticky;
            top: 0;
            background: var(--darker-bg);
            padding: 0.5rem 0;
            z-index: 10;
        }

        .places-count {
            background: var(--primary-red);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* ========== PLACE CARD WITH IMAGE ========== */
        .place-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            margin-bottom: 0.8rem;
            transition: var(--transition);
            border: 1px solid transparent;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .place-card:hover {
            transform: translateY(-2px);
            border-color: rgba(230, 0, 18, 0.3);
            box-shadow: var(--shadow);
        }

        .place-card.active {
            border-color: var(--primary-red);
            background: linear-gradient(to right, rgba(230, 0, 18, 0.05), transparent);
        }

        .place-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: var(--radius) var(--radius) 0 0;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .place-content {
            padding: 1rem;
        }

        .place-category {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.3rem 0.8rem;
            border-radius: 30px;
            font-size: 0.7rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.5);
        }

        .pokemon-badge { color: #ffcb05; }
        .food-badge { color: var(--accent-yellow); }
        .matcha-badge { color: var(--accent-green); }
        .mochi-badge { color: var(--accent-purple); }
        .ramen-badge { color: #dc2626; }
        .streetfood-badge { color: var(--accent-orange); }
        .teamlab-badge { color: var(--accent-blue); }
        .onsen-badge { color: var(--accent-cyan); }
        .shopping-badge { color: var(--accent-pink); }
        .culture-badge { color: #a855f7; }
        .sweets-badge { color: #ec4899; }
        .anime-badge { color: #3b82f6; }

        .place-card h3 {
            font-size: 1rem;
            margin-bottom: 0.4rem;
            color: var(--text-light);
            padding-right: 70px;
        }

        .place-location {
            color: var(--text-gray);
            font-size: 0.8rem;
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .place-description {
            color: var(--text-gray);
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 0.8rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .place-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-bottom: 0.8rem;
        }

        .tag {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-gray);
            padding: 0.2rem 0.5rem;
            border-radius: 30px;
            font-size: 0.7rem;
        }

        .place-actions {
            display: flex;
            gap: 0.6rem;
        }

        .place-action-btn {
            flex: 1;
            padding: 0.5rem;
            background: rgba(230, 0, 18, 0.1);
            border: 1px solid rgba(230, 0, 18, 0.3);
            border-radius: 8px;
            color: var(--primary-red-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
        }

        .place-action-btn:hover {
            background: rgba(230, 0, 18, 0.2);
        }

        .directions-btn {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
            color: var(--accent-green);
        }

        .image-btn {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: var(--accent-blue);
        }

        /* ========== MAP CONTAINER ========== */
        .map-container {
            flex: 1;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* ========== IMAGE GALLERY MODAL ========== */
        .gallery-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2001;
            padding: 1rem;
        }

        .gallery-content {
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            background: var(--darker-bg);
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
        }

        .gallery-main-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            display: block;
        }

        .gallery-info {
            padding: 1.5rem;
        }

        .gallery-info h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .gallery-info p {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .gallery-thumbnails {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            background: var(--dark-bg);
        }

        .thumbnail {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            opacity: 0.7;
            transition: var(--transition);
        }

        .thumbnail:hover, .thumbnail.active {
            opacity: 1;
            transform: scale(1.05);
            border: 2px solid var(--primary-red);
        }

        .close-gallery {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ========== MOBILE FILTERS BAR ========== */
        .mobile-filters {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: var(--card-bg);
            padding: 0.8rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            white-space: nowrap;
            scrollbar-width: none;
            z-index: 900;
            display: none;
        }

        .mobile-filters::-webkit-scrollbar {
            display: none;
        }

        .filter-chips {
            display: inline-flex;
            gap: 0.6rem;
            padding: 0.2rem;
        }

        .filter-chip {
            padding: 0.6rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-gray);
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .filter-chip.active {
            background: rgba(230, 0, 18, 0.2);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
            font-weight: 600;
        }

        /* ========== MOBILE CONTROLS ========== */
        .mobile-controls {
            position: absolute;
            bottom: 90px;
            right: 15px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            display: none;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
            font-size: 1.2rem;
        }

        .control-btn:hover {
            background: var(--primary-red);
            transform: scale(1.1);
        }

        /* ========== MOBILE BOTTOM NAV ========== */
        .mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--darker-bg);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            padding: 0.8rem 1rem;
            display: flex;
            justify-content: space-around;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: none;
        }

        .nav-btn {
            background: transparent;
            border: none;
            color: var(--text-gray);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            flex: 1;
        }

        .nav-btn.active {
            color: var(--primary-red);
        }

        .nav-btn i {
            font-size: 1.2rem;
        }

        .nav-btn span {
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* ========== MODALS ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal {
            background: var(--darker-bg);
            border-radius: var(--radius);
            padding: 1.5rem;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: var(--shadow);
            border: 1px solid rgba(230, 0, 18, 0.3);
        }

        .modal h3 {
            margin-bottom: 1rem;
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .modal p {
            color: var(--text-gray);
            margin-bottom: 1.5rem;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-top: 1.5rem;
        }

        .donate-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            text-decoration: none;
            color: var(--text-light);
            transition: var(--transition);
        }

        .donate-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .donate-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .paypal { background: #003087; color: white; }
        .kofi { background: #FF5E5B; color: white; }

        /* ========== RESPONSIVE DESIGN ========== */
        @media (max-width: 1024px) {
            .sidebar {
                position: fixed;
                top: 70px;
                left: -400px;
                width: 350px;
                height: calc(100vh - 70px);
                z-index: 999;
                box-shadow: 5px 0 20px rgba(0, 0, 0, 0.3);
                transition: var(--transition);
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-filters,
            .mobile-controls,
            .mobile-bottom-nav {
                display: flex;
            }
            
            .header-text p {
                display: block;
            }
            
            .header-actions {
                display: none;
            }
            
            .mobile-header-actions {
                display: flex;
                gap: 0.5rem;
            }
        }

        @media (min-width: 1025px) {
            .sidebar {
                display: flex;
            }
            
            .mobile-header-actions {
                display: none;
            }
        }

        /* ========== LANGUAGE SELECTOR MOBILE ========== */
        .mobile-header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* ========== LOADING STATES ========== */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 1.2rem;
            color: var(--text-gray);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(230, 0, 18, 0.3);
            border-top-color: var(--primary-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========== CUSTOM SCROLLBAR ========== */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-red);
            border-radius: 10px;
        }

        /* ========== OVERLAY ========== */
        .overlay-backdrop {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 998;
            display: none;
        }

        .overlay-backdrop.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <div class="logo">M</div>
            <div class="header-text">
                <h1>Japan Explorer Pro</h1>
                <p>@Muchan_official â€¢ 1000+ spots</p>
            </div>
        </div>
        
        <div class="header-actions">
            <select class="language-selector" id="languageSelect">
                <option value="en">ðŸ‡¬ðŸ‡§ English</option>
                <option value="nl">ðŸ‡³ðŸ‡± Dutch</option>
                <option value="de">ðŸ‡©ðŸ‡ª German</option>
                <option value="es">ðŸ‡ªðŸ‡¸ Spanish</option>
                <option value="tr">ðŸ‡¹ðŸ‡· Turkish</option>
                <option value="ja">ðŸ‡¯ðŸ‡µ Japanese</option>
            </select>
            <button class="donate-btn" id="donateBtn">
                <i class="fas fa-heart"></i> Donate
            </button>
            <a href="https://www.youtube.com/@Muchan94" target="_blank" class="youtube-badge">
                <i class="fab fa-youtube"></i> YouTube
            </a>
            <a href="https://www.tiktok.com/@muchan_official?_r=1&_t=ZG-91sf9Jp4d0L" target="_blank" class="tiktok-badge">
                <i class="fab fa-tiktok"></i> TikTok
            </a>
        </div>
        
        <div class="mobile-header-actions">
            <select class="language-selector" id="mobileLanguageSelect">
                <option value="en">EN</option>
                <option value="nl">NL</option>
                <option value="de">DE</option>
                <option value="es">ES</option>
                <option value="tr">TR</option>
                <option value="ja">JP</option>
            </select>
            <button class="donate-btn" id="mobileDonateBtn">
                <i class="fas fa-heart"></i>
            </button>
        </div>
    </header>

    <!-- Mobile Filters -->
    <div class="mobile-filters" id="mobileFilters">
        <div class="filter-chips">
            <button class="filter-chip active" data-category="all">All</button>
            <button class="filter-chip" data-category="pokemon">PokÃ©mon</button>
            <button class="filter-chip" data-category="food">Food</button>
            <button class="filter-chip" data-category="matcha">Matcha</button>
            <button class="filter-chip" data-category="mochi">Mochi</button>
            <button class="filter-chip" data-category="ramen">Ramen</button>
            <button class="filter-chip" data-category="streetfood">Street Food</button>
            <button class="filter-chip" data-category="teamlab">TeamLab</button>
            <button class="filter-chip" data-category="onsen">Onsen</button>
            <button class="filter-chip" data-category="shopping">Shopping</button>
            <button class="filter-chip" data-category="culture">Culture</button>
            <button class="filter-chip" data-category="sweets">Sweets</button>
            <button class="filter-chip" data-category="anime">Anime</button>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchBox" class="search-box" placeholder="Search 1000+ spots in Japan...">
                </div>
            </div>

            <div class="filters-section">
                <h3><i class="fas fa-filter"></i> Filter by Category</h3>
                <div class="filter-row">
                    <button class="filter-btn active" data-category="all">All Spots</button>
                    <button class="filter-btn" data-category="pokemon">PokÃ©mon</button>
                    <button class="filter-btn" data-category="food">Food</button>
                    <button class="filter-btn" data-category="matcha">Matcha</button>
                    <button class="filter-btn" data-category="mochi">Mochi</button>
                </div>
                <div class="filter-row">
                    <button class="filter-btn" data-category="ramen">Ramen</button>
                    <button class="filter-btn" data-category="streetfood">Street Food</button>
                    <button class="filter-btn" data-category="teamlab">TeamLab</button>
                    <button class="filter-btn" data-category="onsen">Onsen</button>
                    <button class="filter-btn" data-category="shopping">Shopping</button>
                </div>
                <div class="filter-row">
                    <button class="filter-btn" data-category="culture">Culture</button>
                    <button class="filter-btn" data-category="sweets">Sweets</button>
                    <button class="filter-btn" data-category="anime">Anime</button>
                </div>

                <h3 style="margin-top: 1.5rem;"><i class="fas fa-map-marker-alt"></i> Filter by Region</h3>
                <select id="regionFilter" class="region-select">
                    <option value="">All Regions</option>
                    <option value="tokyo">Tokyo Area</option>
                    <option value="kansai">Kansai (Osaka/Kyoto)</option>
                    <option value="hokkaido">Hokkaido</option>
                    <option value="chubu">Chubu (Nagoya)</option>
                    <option value="chugoku">Chugoku (Hiroshima)</option>
                    <option value="shikoku">Shikoku</option>
                    <option value="kyushu">Kyushu</option>
                    <option value="okinawa">Okinawa</option>
                </select>

                <div class="filter-actions">
                    <button class="action-btn secondary" id="clearFilters">
                        <i class="fas fa-undo"></i> Clear
                    </button>
                    <button class="action-btn primary" id="applyFilters">
                        <i class="fas fa-check"></i> Apply
                    </button>
                </div>
            </div>

            <div class="places-list">
                <div class="places-header">
                    <h3><i class="fas fa-map-marker-alt"></i> Discover Japan</h3>
                    <span id="placesCount" class="places-count">Loading...</span>
                </div>
                <div id="placesContainer">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        Loading 1000+ Japan spots...
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div id="map"></div>
            
            <!-- Overlay Backdrop -->
            <div class="overlay-backdrop" id="overlayBackdrop"></div>
            
            <!-- Map Controls -->
            <div class="mobile-controls" id="mobileControls">
                <button class="control-btn" id="toggleSidebar" title="Toggle sidebar">
                    <i class="fas fa-list"></i>
                </button>
                <button class="control-btn" id="locateMe" title="Locate me">
                    <i class="fas fa-location-crosshairs"></i>
                </button>
                <button class="control-btn" id="zoomIn" title="Zoom in">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="control-btn" id="zoomOut" title="Zoom out">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="control-btn" id="fitMarkers" title="Show all">
                    <i class="fas fa-globe-asia"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Image Gallery Modal -->
    <div class="gallery-modal" id="galleryModal">
        <div class="gallery-content">
            <button class="close-gallery" id="closeGallery">
                <i class="fas fa-times"></i>
            </button>
            <img id="galleryMainImage" class="gallery-main-image" src="" alt="">
            <div class="gallery-info">
                <h3 id="galleryTitle"></h3>
                <p id="galleryDescription"></p>
                <div class="gallery-thumbnails" id="galleryThumbnails">
                    <!-- Thumbnails will be added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav" id="mobileNav">
        <button class="nav-btn active" id="navMap">
            <i class="fas fa-map"></i>
            <span>Map</span>
        </button>
        <button class="nav-btn" id="navSearch">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </button>
        <button class="nav-btn" id="navFilters">
            <i class="fas fa-filter"></i>
            <span>Filters</span>
        </button>
        <button class="nav-btn" id="navFavorites">
            <i class="fas fa-heart"></i>
            <span>Saved</span>
        </button>
        <button class="nav-btn" id="navMenu">
            <i class="fas fa-bars"></i>
            <span>Menu</span>
        </button>
    </nav>

    <!-- Donate Modal -->
    <div class="modal-overlay" id="donateModal">
        <div class="modal">
            <h3><i class="fas fa-heart"></i> Support @Muchan_official</h3>
            <p>This interactive Japan map with 1000+ spots is completely free! If you find it helpful and want to support my work, you can donate via:</p>
            
            <div class="modal-buttons">
                <a href="https://paypal.me/muchanofficial" target="_blank" class="donate-option">
                    <div class="donate-icon paypal">
                        <i class="fab fa-paypal"></i>
                    </div>
                    <div>
                        <strong>PayPal</strong>
                        <div style="font-size: 0.85rem; color: var(--text-gray);">One-time donation</div>
                    </div>
                </a>
                
                <a href="https://ko-fi.com/muchan_official" target="_blank" class="donate-option">
                    <div class="donate-icon kofi">
                        <i class="fas fa-mug-hot"></i>
                    </div>
                    <div>
                        <strong>Ko-fi</strong>
                        <div style="font-size: 0.85rem; color: var(--text-gray);">Monthly support</div>
                    </div>
                </a>
            </div>
            
            <p style="margin-top: 1.5rem; font-size: 0.85rem; color: var(--text-gray); text-align: center;">
                <i class="fas fa-star"></i> Follow me on TikTok & YouTube for more Japan content!
            </p>
            
            <div style="display: flex; gap: 1rem; margin-top: 1rem; justify-content: center;">
                <a href="https://www.tiktok.com/@muchan_official" target="_blank" class="tiktok-badge" style="font-size: 0.8rem;">
                    <i class="fab fa-tiktok"></i> TikTok
                </a>
                <a href="https://www.youtube.com/@Muchan94" target="_blank" class="youtube-badge" style="font-size: 0.8rem;">
                    <i class="fab fa-youtube"></i> YouTube
                </a>
            </div>
            
            <button class="action-btn primary" id="closeDonateModal" style="width: 100%; margin-top: 1.5rem;">
                Continue Exploring
            </button>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal-overlay" id="shareModal">
        <div class="modal">
            <h3><i class="fas fa-share-alt"></i> Share Japan Explorer</h3>
            <p>Share this interactive map with your friends who are visiting Japan!</p>
            <div class="modal-buttons">
                <button class="action-btn primary" onclick="shareTo('whatsapp')" style="background: #25D366;">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </button>
                <button class="action-btn primary" onclick="shareTo('tiktok')" style="background: #000;">
                    <i class="fab fa-tiktok"></i> TikTok
                </button>
                <button class="action-btn primary" onclick="shareTo('telegram')" style="background: #0088cc;">
                    <i class="fab fa-telegram"></i> Telegram
                </button>
                <button class="action-btn secondary" id="closeShareModal">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // ========== MULTI-LANGUAGE SUPPORT ==========
        const translations = {
            en: {
                searchPlaceholder: "Search 1000+ spots in Japan...",
                allSpots: "All Spots",
                discoverJapan: "Discover Japan",
                filterByCategory: "Filter by Category",
                filterByRegion: "Filter by Region",
                allRegions: "All Regions",
                tokyoArea: "Tokyo Area",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Clear",
                apply: "Apply",
                directions: "Directions",
                viewImages: "View Images",
                share: "Share",
                loading: "Loading 1000+ Japan spots...",
                noResults: "No places found. Try another filter.",
                showingResults: "Showing {count} of {total} places. Refine your search for more specific results.",
                donateTitle: "Support @Muchan_official",
                donateText: "This interactive Japan map with 1000+ spots is completely free! If you find it helpful and want to support my work, you can donate via:",
                followText: "Follow me on TikTok & YouTube for more Japan content!",
                shareTitle: "Share Japan Explorer",
                shareText: "Share this interactive map with your friends who are visiting Japan!"
            },
            nl: {
                searchPlaceholder: "Zoek 1000+ locaties in Japan...",
                allSpots: "Alle Locaties",
                discoverJapan: "Ontdek Japan",
                filterByCategory: "Filter op Categorie",
                filterByRegion: "Filter op Regio",
                allRegions: "Alle Regio's",
                tokyoArea: "Tokyo Gebied",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Wis",
                apply: "Toepassen",
                directions: "Routebeschrijving",
                viewImages: "Bekijk Foto's",
                share: "Delen",
                loading: "1000+ Japan locaties laden...",
                noResults: "Geen locaties gevonden. Probeer een andere filter.",
                showingResults: "Toont {count} van {total} locaties. Verfijn je zoekopdracht voor specifiekere resultaten.",
                donateTitle: "Ondersteun @Muchan_official",
                donateText: "Deze interactieve Japan kaart met 1000+ locaties is volledig gratis! Als je het nuttig vindt en mijn werk wilt steunen, kun je doneren via:",
                followText: "Volg me op TikTok & YouTube voor meer Japan inhoud!",
                shareTitle: "Deel Japan Explorer",
                shareText: "Deel deze interactieve kaart met je vrienden die Japan bezoeken!"
            },
            de: {
                searchPlaceholder: "Suche 1000+ Orte in Japan...",
                allSpots: "Alle Orte",
                discoverJapan: "Entdecke Japan",
                filterByCategory: "Nach Kategorie filtern",
                filterByRegion: "Nach Region filtern",
                allRegions: "Alle Regionen",
                tokyoArea: "Tokyo Gebiet",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "LÃ¶schen",
                apply: "Anwenden",
                directions: "Wegbeschreibung",
                viewImages: "Bilder ansehen",
                share: "Teilen",
                loading: "1000+ Japan Orte laden...",
                noResults: "Keine Orte gefunden. Versuche einen anderen Filter.",
                showingResults: "Zeige {count} von {total} Orten. Verfeinere deine Suche fÃ¼r spezifischere Ergebnisse.",
                donateTitle: "UnterstÃ¼tze @Muchan_official",
                donateText: "Diese interaktive Japan Karte mit 1000+ Orten ist komplett kostenlos! Wenn du sie hilfreich findest und meine Arbeit unterstÃ¼tzen mÃ¶chtest, kannst du spenden Ã¼ber:",
                followText: "Folge mir auf TikTok & YouTube fÃ¼r mehr Japan Inhalt!",
                shareTitle: "Japan Explorer teilen",
                shareText: "Teile diese interaktive Karte mit Freunden, die Japan besuchen!"
            },
            es: {
                searchPlaceholder: "Buscar 1000+ lugares en JapÃ³n...",
                allSpots: "Todos los Lugares",
                discoverJapan: "Descubre JapÃ³n",
                filterByCategory: "Filtrar por CategorÃ­a",
                filterByRegion: "Filtrar por RegiÃ³n",
                allRegions: "Todas las Regiones",
                tokyoArea: "Ãrea de Tokio",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Limpiar",
                apply: "Aplicar",
                directions: "Indicaciones",
                viewImages: "Ver ImÃ¡genes",
                share: "Compartir",
                loading: "Cargando 1000+ lugares de JapÃ³n...",
                noResults: "No se encontraron lugares. Prueba con otro filtro.",
                showingResults: "Mostrando {count} de {total} lugares. Refina tu bÃºsqueda para resultados mÃ¡s especÃ­ficos.",
                donateTitle: "Apoya a @Muchan_official",
                donateText: "Â¡Este mapa interactivo de JapÃ³n con 1000+ lugares es completamente gratis! Si lo encuentras Ãºtil y quieres apoyar mi trabajo, puedes donar a travÃ©s de:",
                followText: "Â¡SÃ­gueme en TikTok & YouTube para mÃ¡s contenido de JapÃ³n!",
                shareTitle: "Compartir Japan Explorer",
                shareText: "Â¡Comparte este mapa interactivo con tus amigos que visiten JapÃ³n!"
            },
            tr: {
                searchPlaceholder: "Japonya'da 1000+ yer ara...",
                allSpots: "TÃ¼m Yerler",
                discoverJapan: "Japonya'yÄ± KeÅŸfet",
                filterByCategory: "Kategoriye GÃ¶re Filtrele",
                filterByRegion: "BÃ¶lgeye GÃ¶re Filtrele",
                allRegions: "TÃ¼m BÃ¶lgeler",
                tokyoArea: "Tokyo BÃ¶lgesi",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Temizle",
                apply: "Uygula",
                directions: "Yol Tarifi",
                viewImages: "GÃ¶rÃ¼ntÃ¼leri GÃ¶r",
                share: "PaylaÅŸ",
                loading: "1000+ Japonya yeri yÃ¼kleniyor...",
                noResults: "Yer bulunamadÄ±. BaÅŸka bir filtre deneyin.",
                showingResults: "{total} yerden {count} gÃ¶steriliyor. Daha spesifik sonuÃ§lar iÃ§in aramanÄ±zÄ± daraltÄ±n.",
                donateTitle: "@Muchan_official'Ä± Destekle",
                donateText: "1000+ yeri olan bu interaktif Japonya haritasÄ± tamamen Ã¼cretsiz! YararlÄ± buluyorsanÄ±z ve Ã§alÄ±ÅŸmalarÄ±mÄ± desteklemek isterseniz, ÅŸu yollarla baÄŸÄ±ÅŸ yapabilirsiniz:",
                followText: "Daha fazla Japonya iÃ§eriÄŸi iÃ§in TikTok & YouTube'da beni takip edin!",
                shareTitle: "Japan Explorer'Ä± PaylaÅŸ",
                shareText: "Japonya'yÄ± ziyaret eden arkadaÅŸlarÄ±nÄ±zla bu interaktif haritayÄ± paylaÅŸÄ±n!"
            },
            ja: {
                searchPlaceholder: "æ—¥æœ¬ã§1000ä»¥ä¸Šã®ã‚¹ãƒãƒƒãƒˆã‚’æ¤œç´¢...",
                allSpots: "å…¨ã¦ã®ã‚¹ãƒãƒƒãƒˆ",
                discoverJapan: "æ—¥æœ¬ã‚’ç™ºè¦‹",
                filterByCategory: "ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼",
                filterByRegion: "åœ°åŸŸã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼",
                allRegions: "å…¨ã¦ã®åœ°åŸŸ",
                tokyoArea: "æ±äº¬ã‚¨ãƒªã‚¢",
                kansai: "é–¢è¥¿ï¼ˆå¤§é˜ª/äº¬éƒ½ï¼‰",
                hokkaido: "åŒ—æµ·é“",
                chubu: "ä¸­éƒ¨ï¼ˆåå¤å±‹ï¼‰",
                chugoku: "ä¸­å›½ï¼ˆåºƒå³¶ï¼‰",
                shikoku: "å››å›½",
                kyushu: "ä¹å·ž",
                okinawa: "æ²–ç¸„",
                clear: "ã‚¯ãƒªã‚¢",
                apply: "é©ç”¨",
                directions: "é“é †",
                viewImages: "ç”»åƒã‚’è¦‹ã‚‹",
                share: "å…±æœ‰",
                loading: "1000ä»¥ä¸Šã®æ—¥æœ¬ã‚¹ãƒãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...",
                noResults: "å ´æ‰€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚åˆ¥ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚",
                showingResults: "{total}ä»¶ä¸­{count}ä»¶ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚ã‚ˆã‚Šå…·ä½“çš„ãªçµæžœã‚’å¾—ã‚‹ã«ã¯æ¤œç´¢ã‚’çµžã‚Šè¾¼ã‚“ã§ãã ã•ã„ã€‚",
                donateTitle: "@Muchan_officialã‚’ã‚µãƒãƒ¼ãƒˆ",
                donateText: "1000ä»¥ä¸Šã®ã‚¹ãƒãƒƒãƒˆãŒã‚ã‚‹ã“ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ—¥æœ¬åœ°å›³ã¯å®Œå…¨ã«ç„¡æ–™ã§ã™ï¼å½¹ã«ç«‹ã¤ã¨æ€ã£ãŸã‚‰ã€ä»¥ä¸‹ã®æ–¹æ³•ã§å¯„ä»˜ã§ãã¾ã™ï¼š",
                followText: "ã‚‚ã£ã¨æ—¥æœ¬ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¦‹ã‚‹ã«ã¯TikTokã¨YouTubeã§ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ï¼",
                shareTitle: "Japan Explorerã‚’å…±æœ‰",
                shareText: "æ—¥æœ¬ã‚’è¨ªã‚Œã‚‹å‹é”ã¨ã“ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªåœ°å›³ã‚’å…±æœ‰ã—ã¾ã—ã‚‡ã†ï¼"
            }
        };

        let currentLanguage = 'en';

        function updateLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];
            
            // Update UI elements
            document.getElementById('searchBox').placeholder = t.searchPlaceholder;
            document.querySelectorAll('.filter-btn[data-category="all"]').forEach(btn => {
                btn.textContent = t.allSpots;
            });
            document.querySelector('h3 i.fa-map-marker-alt').parentElement.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${t.discoverJapan}`;
            document.querySelector('.filters-section h3 i.fa-filter').parentElement.innerHTML = `<i class="fas fa-filter"></i> ${t.filterByCategory}`;
            document.querySelectorAll('.filters-section h3 i.fa-map-marker-alt').forEach(el => {
                if (el.parentElement.textContent.includes('Filter by Region')) {
                    el.parentElement.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${t.filterByRegion}`;
                }
            });
            
            // Update region select
            const regionSelect = document.getElementById('regionFilter');
            regionSelect.innerHTML = `
                <option value="">${t.allRegions}</option>
                <option value="tokyo">${t.tokyoArea}</option>
                <option value="kansai">${t.kansai}</option>
                <option value="hokkaido">${t.hokkaido}</option>
                <option value="chubu">${t.chubu}</option>
                <option value="chugoku">${t.chugoku}</option>
                <option value="shikoku">${t.shikoku}</option>
                <option value="kyushu">${t.kyushu}</option>
                <option value="okinawa">${t.okinawa}</option>
            `;
            
            // Update buttons
            document.getElementById('clearFilters').innerHTML = `<i class="fas fa-undo"></i> ${t.clear}`;
            document.getElementById('applyFilters').innerHTML = `<i class="fas fa-check"></i> ${t.apply}`;
            
            // Update place cards if they exist
            renderPlacesList();
        }

        // ========== 1000+ JAPAN SPOTS DATABASE WITH IMAGES ==========
        const JAPAN_SPOTS = generateJapanSpots(1200);

        function generateJapanSpots(count) {
            const spots = [];
            const categories = [
                'pokemon', 'food', 'matcha', 'mochi', 'ramen', 'streetfood', 
                'teamlab', 'onsen', 'shopping', 'culture', 'sweets', 'anime'
            ];
            
            const prefectures = [
                {name: 'Tokyo', lat: 35.6762, lng: 139.6503, cities: ['Tokyo', 'Shibuya', 'Shinjuku', 'Ikebukuro', 'Akihabara', 'Asakusa', 'Ueno', 'Ginza', 'Roppongi', 'Harajuku', 'Shimokitazawa']},
                {name: 'Kyoto', lat: 35.0116, lng: 135.7681, cities: ['Kyoto', 'Gion', 'Arashiyama', 'Fushimi', 'Higashiyama', 'Uji']},
                {name: 'Osaka', lat: 34.6937, lng: 135.5023, cities: ['Osaka', 'Namba', 'Umeda', 'Shinsekai', 'Tennoji', 'Dotonbori']},
                {name: 'Hokkaido', lat: 43.0642, lng: 141.3469, cities: ['Sapporo', 'Otaru', 'Hakodate', 'Furano', 'Noboribetsu']},
                {name: 'Kanagawa', lat: 35.4475, lng: 139.6425, cities: ['Yokohama', 'Kamakura', 'Hakone', 'Enoshima', 'Kawasaki']},
                {name: 'Aichi', lat: 35.1802, lng: 136.9066, cities: ['Nagoya', 'Inuyama', 'Toyota', 'Tokoname']},
                {name: 'Fukuoka', lat: 33.5902, lng: 130.4017, cities: ['Fukuoka', 'Hakata', 'Dazaifu', 'Kokura']},
                {name: 'Hiroshima', lat: 34.3853, lng: 132.4553, cities: ['Hiroshima', 'Miyajima', 'Kure', 'Onomichi']},
                {name: 'Okinawa', lat: 26.2124, lng: 127.6809, cities: ['Naha', 'Okinawa City', 'Ishigaki', 'Miyakojima']},
                {name: 'Nara', lat: 34.6851, lng: 135.8050, cities: ['Nara', 'Yamatokoriyama', 'Sakurai', 'Kashihara']},
                {name: 'Miyagi', lat: 38.2682, lng: 140.8694, cities: ['Sendai', 'Matsushima', 'Ishinomaki']},
                {name: 'Shizuoka', lat: 34.9769, lng: 138.3831, cities: ['Shizuoka', 'Atami', 'Fuji', 'Izu']},
                {name: 'Gifu', lat: 35.3912, lng: 136.7223, cities: ['Gifu', 'Takayama', 'Gero', 'Shirakawa-go']},
                {name: 'Ishikawa', lat: 36.5947, lng: 136.6256, cities: ['Kanazawa', 'Wajima', 'Kaga', 'Komatsu']}
            ];

            // Image URLs for different categories (using Unsplash for demo)
            const categoryImages = {
                pokemon: [
                    'https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?w=800&q=80',
                    'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w-800&q=80',
                    'https://images.unsplash.com/photo-1593081891731-fda0877988da?w=800&q=80'
                ],
                food: [
                    'https://images.unsplash.com/photo-1553621042-f6e147245754?w=800&q=80',
                    'https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800&q=80',
                    'https://images.unsplash.com/photo-1578474846511-04ba529f0b88?w=800&q=80'
                ],
                matcha: [
                    'https://images.unsplash.com/photo-1561047029-3000c68339ca?w=800&q=80',
                    'https://images.unsplash.com/photo-1559177243-0b3073a84b0c?w=800&q=80',
                    'https://images.unsplash.com/photo-1558981806-5b5d4a99fad5?w=800&q=80'
                ],
                mochi: [
                    'https://images.unsplash.com/photo-1563241527-3004b7be0ffc?w=800&q=80',
                    'https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&q=80',
                    'https://images.unsplash.com/photo-1562448079-b5631897423b?w=800&q=80'
                ],
                ramen: [
                    'https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=800&q=80',
                    'https://images.unsplash.com/photo-1557872943-16a5ac26437e?w=800&q=80',
                    'https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=800&q=80'
                ],
                streetfood: [
                    'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=800&q=80',
                    'https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=800&q=80',
                    'https://images.unsplash.com/photo-1544025162-d76694265947?w=800&q=80'
                ],
                teamlab: [
                    'https://images.unsplash.com/photo-1542744095-fcf48d80b0fd?w=800&q=80',
                    'https://images.unsplash.com/photo-1542751371-adc38448a05e?w=800&q=80',
                    'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?w=800&q=80'
                ],
                onsen: [
                    'https://images.unsplash.com/photo-1548878811-cddbc06f9d4c?w=800&q=80',
                    'https://images.unsplash.com/photo-1578301978693-85fa9c0320b9?w=800&q=80',
                    'https://images.unsplash.com/photo-1588392382834-a891154bca4d?w=800&q=80'
                ],
                shopping: [
                    'https://images.unsplash.com/photo-1551818255-e6e109cbcbcd?w=800&q=80',
                    'https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?w=800&q=80',
                    'https://images.unsplash.com/photo-1555529669-e69e7aa0ba9a?w=800&q=80'
                ],
                culture: [
                    'https://images.unsplash.com/photo-1528164344705-47542687000d?w=800&q=80',
                    'https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=800&q=80',
                    'https://images.unsplash.com/photo-1542640244-7e672d6cef4e?w=800&q=80'
                ],
                sweets: [
                    'https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=800&q=80',
                    'https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=800&q=80',
                    'https://images.unsplash.com/photo-1562448079-b5631897423b?w=800&q=80'
                ],
                anime: [
                    'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80',
                    'https://images.unsplash.com/photo-1545569341-9eb8b30979d9?w=800&q=80',
                    'https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=800&q=80'
                ]
            };

            // Famous real spots with actual images
            const famousSpots = [
                {
                    id: 'tokyo_pokemon_dx',
                    name: 'PokÃ©mon Center TOKYO DX',
                    lat: 35.6695,
                    lng: 139.7626,
                    city: 'Tokyo',
                    prefecture: 'Tokyo',
                    category: 'pokemon',
                    description: 'Largest PokÃ©mon Center with exclusive Tokyo merch and PokÃ©mon CafÃ©.',
                    tags: ['pokemon', 'shop', 'collectibles'],
                    images: categoryImages.pokemon
                },
                {
                    id: 'teamlab_planets',
                    name: 'teamLab Planets TOKYO',
                    lat: 35.6261,
                    lng: 139.7817,
                    city: 'Tokyo',
                    prefecture: 'Tokyo',
                    category: 'teamlab',
                    description: 'Immersive digital art museum. Walk through water installations.',
                    tags: ['teamlab', 'art', 'instagram'],
                    images: categoryImages.teamlab
                },
                {
                    id: 'ichiran_shibuya',
                    name: 'Ichiran Ramen Shibuya',
                    lat: 35.6590,
                    lng: 139.6993,
                    city: 'Tokyo',
                    prefecture: 'Tokyo',
                    category: 'ramen',
                    description: 'Famous tonkotsu ramen chain with private booths.',
                    tags: ['ramen', 'tonkotsu', 'iconic'],
                    images: categoryImages.ramen
                },
                {
                    id: 'fushimi_inari',
                    name: 'Fushimi Inari Shrine',
                    lat: 34.9671,
                    lng: 135.7727,
                    city: 'Kyoto',
                    prefecture: 'Kyoto',
                    category: 'culture',
                    description: 'Famous thousand torii gates. Visit early morning for photos.',
                    tags: ['shrine', 'torii', 'photospot'],
                    images: categoryImages.culture
                },
                {
                    id: 'dotonbori_food',
                    name: 'Dotonbori Street Food',
                    lat: 34.6687,
                    lng: 135.5011,
                    city: 'Osaka',
                    prefecture: 'Osaka',
                    category: 'streetfood',
                    description: 'Iconic food street with takoyaki, okonomiyaki, kushikatsu.',
                    tags: ['streetfood', 'takoyaki', 'iconic'],
                    images: categoryImages.streetfood
                }
            ];

            // Add famous spots
            famousSpots.forEach(spot => spots.push(spot));

            // Generate remaining spots
            for (let i = spots.length + 1; i <= count; i++) {
                const prefecture = prefectures[Math.floor(Math.random() * prefectures.length)];
                const city = prefecture.cities[Math.floor(Math.random() * prefecture.cities.length)];
                const category = categories[Math.floor(Math.random() * categories.length)];
                
                // Generate random coordinates
                const lat = prefecture.lat + (Math.random() - 0.5) * 0.5;
                const lng = prefecture.lng + (Math.random() - 0.5) * 0.8;
                
                // Name based on category
                const names = {
                    pokemon: ['PokÃ©mon Center', 'PokÃ©mon Store', 'Anime Shop', 'Card Battle Cafe'],
                    food: ['Sushi Restaurant', 'Tempura House', 'Izakaya', 'Local Eatery'],
                    matcha: ['Matcha Cafe', 'Tea Ceremony', 'Green Tea House', 'Traditional Tea'],
                    mochi: ['Mochi Workshop', 'Wagashi Shop', 'Traditional Sweets', 'Mochi Master'],
                    ramen: ['Ramen Shop', 'Noodle House', 'Ramen Street', 'Local Ramen'],
                    streetfood: ['Food Stall', 'Night Market', 'Street Food', 'Takoyaki Stand'],
                    teamlab: ['Digital Art', 'Interactive Exhibit', 'Art Installation', 'Light Show'],
                    onsen: ['Hot Spring', 'Public Bath', 'Onsen Resort', 'Spa'],
                    shopping: ['Shopping Street', 'Market', 'Boutique', 'Souvenir Shop'],
                    culture: ['Temple', 'Shrine', 'Historic Site', 'Traditional House'],
                    sweets: ['Dessert Cafe', 'Sweet Shop', 'Wagashi Store', 'Traditional Sweets'],
                    anime: ['Anime Shop', 'Collectibles Store', 'Manga Cafe', 'Anime Museum']
                };
                
                const name = names[category][Math.floor(Math.random() * names[category].length)] + ' ' + city;
                const description = `A wonderful ${category} spot in ${city}. Perfect for experiencing authentic Japanese culture.`;
                
                spots.push({
                    id: `spot_${i}`,
                    name: name,
                    lat: lat,
                    lng: lng,
                    city: city,
                    prefecture: prefecture.name,
                    category: category,
                    description: description,
                    tags: [category, 'japan', city.toLowerCase()],
                    images: categoryImages[category] || categoryImages.culture
                });
            }
            
            return spots;
        }

        // ========== APP STATE ==========
        let map;
        let markers = [];
        let filteredPlaces = [...JAPAN_SPOTS];
        let currentCategory = 'all';
        let selectedPlaceId = null;
        let favorites = JSON.parse(localStorage.getItem('japanFavorites')) || [];
        let currentRegion = '';

        // ========== INITIALIZE APP ==========
        function initApp() {
            initMap();
            renderPlacesList();
            updatePlacesCount();
            setupEventListeners();
            setupResponsive();
            
            // Load saved language preference
            const savedLang = localStorage.getItem('japanExplorerLang') || 'en';
            document.getElementById('languageSelect').value = savedLang;
            document.getElementById('mobileLanguageSelect').value = savedLang;
            updateLanguage(savedLang);
            
            // Show initial loading then hide
            setTimeout(() => {
                const placesContainer = document.getElementById('placesContainer');
                if (placesContainer) {
                    placesContainer.innerHTML = '';
                    renderPlacesList();
                }
            }, 500);
        }

        // ========== MAP FUNCTIONS ==========
        function initMap() {
            map = L.map('map', {
                zoomControl: false,
                attributionControl: false
            }).setView([36.2048, 138.2529], 5);
            
            // Use OpenStreetMap with English labels
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                maxZoom: 19,
                attribution: 'Â© OpenStreetMap contributors, Â© CARTO'
            }).addTo(map);
            
            addMarkersToMap();
            
            // Fit bounds to Japan
            const japanBounds = L.latLngBounds(
                [24.3963, 122.9346],
                [45.5232, 145.8209]
            );
            map.fitBounds(japanBounds);
        }

        function addMarkersToMap() {
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            filteredPlaces.forEach(place => {
                const marker = L.marker([place.lat, place.lng], {
                    icon: getMarkerIcon(place.category)
                });
                
                const popupContent = `
                    <div style="max-width: 250px;">
                        <h4 style="margin: 0 0 8px; color: #1e293b;">${place.name}</h4>
                        <div style="color: #64748b; font-size: 0.9rem; margin-bottom: 8px;">
                            <i class="fas fa-map-marker-alt"></i> ${place.city}, ${place.prefecture}
                        </div>
                        <div style="color: #475569; font-size: 0.85rem; margin-bottom: 12px;">
                            ${place.description}
                        </div>
                        <div style="display: flex; gap: 5px; margin-top: 10px;">
                            <button onclick="openDirections(${place.lat}, ${place.lng})" style="flex:1; padding: 6px; background: #e60012; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                <i class="fas fa-directions"></i> ${translations[currentLanguage].directions}
                            </button>
                            <button onclick="showImageGallery('${place.id}')" style="flex:1; padding: 6px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                <i class="fas fa-images"></i> ${translations[currentLanguage].viewImages}
                            </button>
                        </div>
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                
                marker.on('click', () => {
                    selectPlace(place.id);
                    if (window.innerWidth < 1025) {
                        toggleSidebar(true);
                    }
                });
                
                marker.addTo(map);
                markers.push(marker);
            });
        }

        function getMarkerIcon(category) {
            const colors = {
                pokemon: '#FFCB05',
                food: '#F59E0B',
                matcha: '#10B981',
                mochi: '#8B5CF6',
                ramen: '#DC2626',
                streetfood: '#F97316',
                teamlab: '#3B82F6',
                onsen: '#06B6D4',
                shopping: '#EC4899',
                culture: '#A855F7',
                sweets: '#EC4899',
                anime: '#3B82F6'
            };
            
            const color = colors[category] || '#E60012';
            const iconHtml = `
                <div style="
                    background: ${color};
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    border: 2px solid white;
                    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 9px;
                ">
                    <i class="fas fa-${getCategoryIcon(category)}"></i>
                </div>
            `;
            
            return L.divIcon({
                html: iconHtml,
                className: 'custom-marker',
                iconSize: [24, 24],
                iconAnchor: [12, 24]
            });
        }

        function getCategoryIcon(category) {
            const icons = {
                pokemon: 'gamepad',
                food: 'utensils',
                matcha: 'leaf',
                mochi: 'cookie-bite',
                ramen: 'bowl-food',
                streetfood: 'hotdog',
                teamlab: 'palette',
                onsen: 'hot-tub',
                shopping: 'shopping-bag',
                culture: 'landmark',
                sweets: 'candy-cane',
                anime: 'tv'
            };
            return icons[category] || 'map-marker-alt';
        }

        // ========== IMAGE GALLERY FUNCTIONS ==========
        function showImageGallery(placeId) {
            const place = JAPAN_SPOTS.find(p => p.id === placeId);
            if (!place || !place.images) return;
            
            document.getElementById('galleryTitle').textContent = place.name;
            document.getElementById('galleryDescription').textContent = place.description;
            document.getElementById('galleryMainImage').src = place.images[0];
            
            const thumbnailsContainer = document.getElementById('galleryThumbnails');
            thumbnailsContainer.innerHTML = '';
            
            place.images.forEach((img, index) => {
                const thumbnail = document.createElement('img');
                thumbnail.className = 'thumbnail' + (index === 0 ? ' active' : '');
                thumbnail.src = img;
                thumbnail.onclick = () => {
                    document.getElementById('galleryMainImage').src = img;
                    document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
                    thumbnail.classList.add('active');
                };
                thumbnailsContainer.appendChild(thumbnail);
            });
            
            document.getElementById('galleryModal').style.display = 'flex';
        }

        // ========== UI FUNCTIONS ==========
        function renderPlacesList() {
            const container = document.getElementById('placesContainer');
            if (!container) return;
            
            const t = translations[currentLanguage];
            
            if (filteredPlaces.length === 0) {
                container.innerHTML = `<div style="text-align: center; color: var(--text-gray); padding: 2rem;">${t.noResults}</div>`;
                return;
            }
            
            let html = '';
            const displayPlaces = filteredPlaces.slice(0, 50);
            
            displayPlaces.forEach(place => {
                const isActive = selectedPlaceId === place.id;
                const isFavorite = favorites.includes(place.id);
                const categoryClass = `${place.category}-badge`;
                const imageUrl = place.images ? place.images[0] : `https://images.unsplash.com/photo-1528164344705-47542687000d?w=800&q=80`;
                
                html += `
                    <div class="place-card ${isActive ? 'active' : ''}" onclick="selectPlace('${place.id}')">
                        <div class="place-image" style="background-image: linear-gradient(135deg, #4f46e5, #7c3aed); background-size: cover; background-position: center;">
                            <img src="${imageUrl}" alt="${place.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: var(--radius) var(--radius) 0 0;">
                        </div>
                        <div class="place-category ${categoryClass}">
                            ${place.category.toUpperCase()}
                        </div>
                        <div class="place-content">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                <h3>${place.name}</h3>
                                <button onclick="toggleFavorite('${place.id}'); event.stopPropagation();" 
                                        style="background: transparent; border: none; color: ${isFavorite ? '#ff4757' : 'var(--text-gray)'}; font-size: 1rem; padding: 0.3rem;">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                            <div class="place-location">
                                <i class="fas fa-map-marker-alt"></i>
                                ${place.city}, ${place.prefecture}
                            </div>
                            <p class="place-description">${place.description}</p>
                            <div class="place-tags">
                                ${place.tags.slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                            <div class="place-actions">
                                <button class="place-action-btn directions-btn" onclick="openDirections(${place.lat}, ${place.lng}); event.stopPropagation();">
                                    <i class="fas fa-directions"></i> ${t.directions}
                                </button>
                                <button class="place-action-btn image-btn" onclick="showImageGallery('${place.id}'); event.stopPropagation();">
                                    <i class="fas fa-images"></i> ${t.viewImages}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            if (filteredPlaces.length > 50) {
                html += `<div style="text-align: center; color: var(--text-gray); padding: 1rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    ${t.showingResults.replace('{count}', 50).replace('{total}', filteredPlaces.length)}
                </div>`;
            }
            
            container.innerHTML = html;
        }

        function updatePlacesCount() {
            const placesCount = document.getElementById('placesCount');
            if (placesCount) {
                placesCount.textContent = `${filteredPlaces.length} places`;
            }
        }

        function selectPlace(placeId) {
            selectedPlaceId = placeId;
            const place = JAPAN_SPOTS.find(p => p.id === placeId);
            
            if (place) {
                map.setView([place.lat, place.lng], 15);
                markers.forEach(marker => {
                    const latLng = marker.getLatLng();
                    if (latLng.lat === place.lat && latLng.lng === place.lng) {
                        marker.openPopup();
                    }
                });
                renderPlacesList();
            }
        }

        function filterPlaces() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            
            filteredPlaces = JAPAN_SPOTS.filter(place => {
                if (currentCategory !== 'all' && place.category !== currentCategory) return false;
                
                if (currentRegion) {
                    const regionMap = {
                        'tokyo': ['Tokyo', 'Kanagawa', 'Chiba', 'Saitama'],
                        'kansai': ['Osaka', 'Kyoto', 'Nara', 'Hyogo', 'Wakayama', 'Shiga'],
                        'hokkaido': ['Hokkaido'],
                        'chubu': ['Aichi', 'Gifu', 'Shizuoka', 'Nagano', 'Toyama', 'Ishikawa', 'Fukui', 'Yamanashi'],
                        'chugoku': ['Hiroshima', 'Okayama', 'Yamaguchi', 'Shimane', 'Tottori'],
                        'shikoku': ['Tokushima', 'Kagawa', 'Ehime', 'Kochi'],
                        'kyushu': ['Fukuoka', 'Kumamoto', 'Kagoshima', 'Oita', 'Miyazaki', 'Nagasaki', 'Saga'],
                        'okinawa': ['Okinawa']
                    };
                    
                    if (!regionMap[currentRegion] || !regionMap[currentRegion].includes(place.prefecture)) {
                        return false;
                    }
                }
                
                if (searchTerm) {
                    const searchText = `${place.name} ${place.city} ${place.prefecture} ${place.description} ${place.tags.join(' ')}`.toLowerCase();
                    return searchText.includes(searchTerm);
                }
                
                return true;
            });
            
            addMarkersToMap();
            renderPlacesList();
            updatePlacesCount();
        }

        // ========== RESPONSIVE FUNCTIONS ==========
        function setupResponsive() {
            const isMobile = window.innerWidth < 1025;
            
            if (isMobile) {
                toggleSidebar(false);
            } else {
                toggleSidebar(true);
            }
            
            updateResponsiveUI();
            window.addEventListener('resize', updateResponsiveUI);
        }

        function updateResponsiveUI() {
            const isMobile = window.innerWidth < 1025;
            
            if (isMobile) {
                document.getElementById('mobileFilters').style.display = 'flex';
                document.getElementById('mobileControls').style.display = 'flex';
                document.getElementById('mobileNav').style.display = 'flex';
            } else {
                document.getElementById('mobileFilters').style.display = 'none';
                document.getElementById('mobileControls').style.display = 'none';
                document.getElementById('mobileNav').style.display = 'none';
            }
        }

        function toggleSidebar(open) {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlayBackdrop');
            
            if (open === undefined) {
                open = !sidebar.classList.contains('active');
            }
            
            if (open) {
                sidebar.classList.add('active');
                overlay.classList.add('active');
            } else {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
            }
        }

        // ========== UTILITY FUNCTIONS ==========
        function openDirections(lat, lng) {
            const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}&travelmode=transit`;
            window.open(url, '_blank');
        }

        function toggleFavorite(placeId) {
            const index = favorites.indexOf(placeId);
            if (index === -1) {
                favorites.push(placeId);
            } else {
                favorites.splice(index, 1);
            }
            localStorage.setItem('japanFavorites', JSON.stringify(favorites));
            renderPlacesList();
        }

        function showFavorites() {
            filteredPlaces = JAPAN_SPOTS.filter(place => favorites.includes(place.id));
            if (filteredPlaces.length === 0) {
                alert('No favorites yet! Tap the heart on any place to save it.');
                filteredPlaces = [...JAPAN_SPOTS];
            }
            addMarkersToMap();
            renderPlacesList();
            updatePlacesCount();
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('navFavorites').classList.add('active');
        }

        // ========== EVENT LISTENERS ==========
        function setupEventListeners() {
            // Language selector
            document.getElementById('languageSelect').addEventListener('change', function() {
                updateLanguage(this.value);
                localStorage.setItem('japanExplorerLang', this.value);
                document.getElementById('mobileLanguageSelect').value = this.value;
            });
            
            document.getElementById('mobileLanguageSelect').addEventListener('change', function() {
                updateLanguage(this.value);
                localStorage.setItem('japanExplorerLang', this.value);
                document.getElementById('languageSelect').value = this.value;
            });
            
            // Search box
            document.getElementById('searchBox').addEventListener('input', filterPlaces);
            
            // Category filters
            document.querySelectorAll('.filter-btn, .filter-chip').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn, .filter-chip').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    filterPlaces();
                });
            });
            
            // Region filter
            document.getElementById('regionFilter').addEventListener('change', function() {
                currentRegion = this.value;
                filterPlaces();
            });
            
            // Filter actions
            document.getElementById('clearFilters').addEventListener('click', () => {
                document.getElementById('searchBox').value = '';
                document.querySelectorAll('.filter-btn, .filter-chip').forEach(b => {
                    b.classList.remove('active');
                    if (b.dataset.category === 'all') b.classList.add('active');
                });
                document.getElementById('regionFilter').value = '';
                currentCategory = 'all';
                currentRegion = '';
                filterPlaces();
            });
            
            document.getElementById('applyFilters').addEventListener('click', filterPlaces);
            
            // Sidebar toggle
            document.getElementById('toggleSidebar').addEventListener('click', () => toggleSidebar());
            document.getElementById('overlayBackdrop').addEventListener('click', () => toggleSidebar(false));
            
            // Map controls
            document.getElementById('locateMe').addEventListener('click', () => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(position => {
                        map.setView([position.coords.latitude, position.coords.longitude], 13);
                    });
                }
            });
            
            document.getElementById('zoomIn').addEventListener('click', () => map.zoomIn());
            document.getElementById('zoomOut').addEventListener('click', () => map.zoomOut());
            document.getElementById('fitMarkers').addEventListener('click', () => {
                if (filteredPlaces.length > 0) {
                    const bounds = L.latLngBounds(filteredPlaces.map(p => [p.lat, p.lng]));
                    map.fitBounds(bounds, { padding: [50, 50] });
                } else {
                    const japanBounds = L.latLngBounds([24.3963, 122.9346], [45.5232, 145.8209]);
                    map.fitBounds(japanBounds);
                }
            });
            
            // Mobile navigation
            const navButtons = ['navMap', 'navSearch', 'navFilters', 'navFavorites', 'navMenu'];
            navButtons.forEach(id => {
                document.getElementById(id).addEventListener('click', function() {
                    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (id === 'navSearch') {
                        document.getElementById('searchBox').focus();
                        toggleSidebar(true);
                    } else if (id === 'navFilters') {
                        toggleSidebar(true);
                    } else if (id === 'navFavorites') {
                        showFavorites();
                    } else if (id === 'navMenu') {
                        document.getElementById('donateModal').style.display = 'flex';
                    } else if (id === 'navMap') {
                        toggleSidebar(false);
                    }
                });
            });
            
            // Donate buttons
            document.getElementById('donateBtn').addEventListener('click', () => {
                document.getElementById('donateModal').style.display = 'flex';
            });
            
            document.getElementById('mobileDonateBtn').addEventListener('click', () => {
                document.getElementById('donateModal').style.display = 'flex';
            });
            
            // Modal close buttons
            document.getElementById('closeDonateModal').addEventListener('click', () => {
                document.getElementById('donateModal').style.display = 'none';
            });
            
            document.getElementById('closeGallery').addEventListener('click', () => {
                document.getElementById('galleryModal').style.display = 'none';
            });
            
            document.getElementById('closeShareModal').addEventListener('click', () => {
                document.getElementById('shareModal').style.display = 'none';
            });
            
            // Close gallery when clicking outside
            document.getElementById('galleryModal').addEventListener('click', (e) => {
                if (e.target.id === 'galleryModal') {
                    document.getElementById('galleryModal').style.display = 'none';
                }
            });
            
            // Handle resize
            window.addEventListener('resize', () => {
                setTimeout(() => map.invalidateSize(), 300);
            });
        }

        // ========== INITIALIZE ==========
        document.addEventListener('DOMContentLoaded', initApp);
        
        // Expose functions to global scope
        window.openDirections = openDirections;
        window.selectPlace = selectPlace;
        window.toggleFavorite = toggleFavorite;
        window.showImageGallery = showImageGallery;
        window.toggleSidebar = toggleSidebar;
    </script>
</body>
</html>
