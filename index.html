<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Japan Explorer Pro ‚Ä¢ @Muchan_official ‚Ä¢ 1000+ Food ‚Ä¢ Pok√©mon ‚Ä¢ Matcha Spots</title>
    <meta name="description" content="Japan's most complete interactive map by @Muchan_official - 1000+ food spots, Pok√©mon Centers, matcha ceremonies, mochi workshops, and hidden gems.">
    <meta name="keywords" content="Japan travel, Pok√©mon Center, matcha, mochi workshop, Tokyo food, Kyoto, Osaka, TeamLab, Muchan_official, TikTok Japan">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== ROOT VARIABLES ========== */
        :root {
            --primary-red: #e60012; /* Japan red */
            --primary-red-light: #ff5252;
            --dark-bg: #0f172a;
            --darker-bg: #0a0f1f;
            --card-bg: #1e293b;
            --text-light: #f8fafc;
            --text-gray: #94a3b8;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-blue: #3b82f6;
            --accent-pink: #ec4899;
            --accent-cyan: #06b6d4;
            --accent-orange: #f97316;
            --radius: 16px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--dark-bg);
            color: var(--text-light);
            overflow: hidden;
            touch-action: pan-y;
        }

        /* ========== HEADER ========== */
        .header {
            background: linear-gradient(135deg, var(--darker-bg) 0%, #1a1f3a 100%);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--primary-red);
            height: 70px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            flex: 1;
        }

        .logo {
            width: 42px;
            height: 42px;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--primary-red-light) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }

        .header-text h1 {
            font-size: 1.1rem;
            background: linear-gradient(90deg, #fff, var(--primary-red-light));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.1rem;
            line-height: 1.2;
        }

        .header-text p {
            color: var(--text-gray);
            font-size: 0.75rem;
            display: none;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .tiktok-badge, .youtube-badge {
            background: #000;
            color: white;
            padding: 0.5rem 0.8rem;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            text-decoration: none;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .youtube-badge {
            background: #ff0000;
        }

        .tiktok-badge:hover, .youtube-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .donate-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            border: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
        }

        .donate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .language-selector {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: var(--text-light);
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            cursor: pointer;
            outline: none;
        }

        /* ========== MAIN LAYOUT ========== */
        .app-container {
            height: 100vh;
            padding-top: 70px;
            display: flex;
        }

        /* ========== SIDEBAR (PC) ========== */
        .sidebar {
            width: 400px;
            background: var(--darker-bg);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            display: none; /* Hidden on mobile by default */
        }

        .sidebar.active {
            display: flex;
        }

        .sidebar-header {
            padding: 1.2rem;
            background: var(--card-bg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .search-container {
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 3rem;
            background: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .search-icon {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-gray);
        }

        /* ========== ADVANCED FILTERS ========== */
        .filters-section {
            padding: 1.2rem;
            background: var(--card-bg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .filters-section h3 {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-bottom: 1rem;
        }

        .filter-btn {
            padding: 0.6rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-gray);
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .filter-btn:hover {
            background: rgba(230, 0, 18, 0.1);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
        }

        .filter-btn.active {
            background: rgba(230, 0, 18, 0.2);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
            font-weight: 600;
        }

        .region-select {
            width: 100%;
            padding: 0.8rem;
            background: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .filter-actions {
            display: flex;
            gap: 0.8rem;
            margin-top: 0.5rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.7rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .action-btn.primary {
            background: var(--primary-red);
            color: white;
        }

        .action-btn.secondary {
            background: transparent;
            border: 1px solid var(--text-gray);
            color: var(--text-gray);
        }

        /* ========== PLACES LIST ========== */
        .places-list {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 1rem;
        }

        .places-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            position: sticky;
            top: 0;
            background: var(--darker-bg);
            padding: 0.5rem 0;
            z-index: 10;
        }

        .places-count {
            background: var(--primary-red);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* ========== PLACE CARD ========== */
        .place-card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 0.8rem;
            transition: var(--transition);
            border: 1px solid transparent;
            cursor: pointer;
            position: relative;
        }

        .place-card:hover {
            transform: translateY(-2px);
            border-color: rgba(230, 0, 18, 0.3);
            box-shadow: var(--shadow);
        }

        .place-card.active {
            border-color: var(--primary-red);
            background: linear-gradient(to right, rgba(230, 0, 18, 0.05), transparent);
        }

        .place-category {
            position: absolute;
            top: 0.8rem;
            right: 0.8rem;
            padding: 0.3rem 0.8rem;
            border-radius: 30px;
            font-size: 0.7rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.5);
        }

        .pokemon-badge { color: #ffcb05; }
        .food-badge { color: var(--accent-yellow); }
        .matcha-badge { color: var(--accent-green); }
        .mochi-badge { color: var(--accent-purple); }
        .ramen-badge { color: #dc2626; }
        .streetfood-badge { color: var(--accent-orange); }
        .teamlab-badge { color: var(--accent-blue); }
        .onsen-badge { color: var(--accent-cyan); }
        .shopping-badge { color: var(--accent-pink); }
        .culture-badge { color: #a855f7; }
        .sweets-badge { color: #ec4899; }
        .anime-badge { color: #3b82f6; }

        .place-card h3 {
            font-size: 1rem;
            margin-bottom: 0.4rem;
            color: var(--text-light);
            padding-right: 70px;
        }

        .place-location {
            color: var(--text-gray);
            font-size: 0.8rem;
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .place-description {
            color: var(--text-gray);
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 0.8rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* ========== GOOGLE STREET VIEW THUMBNAIL ========== */
        .streetview-thumbnail {
            width: 100%;
            height: 180px;
            border-radius: 10px;
            margin-bottom: 0.8rem;
            overflow: hidden;
            position: relative;
            background: var(--dark-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .streetview-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .streetview-thumbnail:hover img {
            transform: scale(1.05);
        }

        .streetview-thumbnail .loading {
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        .streetview-thumbnail .streetview-label {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .place-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
            margin-bottom: 0.8rem;
        }

        .tag {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-gray);
            padding: 0.2rem 0.5rem;
            border-radius: 30px;
            font-size: 0.7rem;
        }

        .place-actions {
            display: flex;
            gap: 0.6rem;
        }

        .place-action-btn {
            flex: 1;
            padding: 0.5rem;
            background: rgba(230, 0, 18, 0.1);
            border: 1px solid rgba(230, 0, 18, 0.3);
            border-radius: 8px;
            color: var(--primary-red-light);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.4rem;
        }

        .place-action-btn:hover {
            background: rgba(230, 0, 18, 0.2);
        }

        .directions-btn {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
            color: var(--accent-green);
        }

        .streetview-btn {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: var(--accent-blue);
        }

        /* ========== MAP CONTAINER ========== */
        .map-container {
            flex: 1;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* ========== GOOGLE STREET VIEW MODAL ========== */
        .streetview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2001;
            padding: 1rem;
        }

        .streetview-content {
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            background: var(--darker-bg);
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
        }

        .streetview-iframe {
            width: 100%;
            height: 500px;
            border: none;
            display: block;
        }

        .streetview-info {
            padding: 1.5rem;
        }

        .streetview-info h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .streetview-info p {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .close-streetview {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ========== MOBILE FILTERS BAR ========== */
        .mobile-filters {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: var(--card-bg);
            padding: 0.8rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            white-space: nowrap;
            scrollbar-width: none;
            z-index: 900;
            display: none;
        }

        .mobile-filters::-webkit-scrollbar {
            display: none;
        }

        .filter-chips {
            display: inline-flex;
            gap: 0.6rem;
            padding: 0.2rem;
        }

        .filter-chip {
            padding: 0.6rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            color: var(--text-gray);
            font-size: 0.85rem;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .filter-chip.active {
            background: rgba(230, 0, 18, 0.2);
            border-color: var(--primary-red);
            color: var(--primary-red-light);
            font-weight: 600;
        }

        /* ========== MOBILE CONTROLS ========== */
        .mobile-controls {
            position: absolute;
            bottom: 90px;
            right: 15px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            display: none;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-light);
            font-size: 1.2rem;
        }

        .control-btn:hover {
            background: var(--primary-red);
            transform: scale(1.1);
        }

        /* ========== MOBILE BOTTOM NAV ========== */
        .mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--darker-bg);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            padding: 0.8rem 1rem;
            display: flex;
            justify-content: space-around;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: none;
        }

        .nav-btn {
            background: transparent;
            border: none;
            color: var(--text-gray);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.3rem;
            padding: 0.5rem;
            cursor: pointer;
            transition: var(--transition);
            flex: 1;
        }

        .nav-btn.active {
            color: var(--primary-red);
        }

        .nav-btn i {
            font-size: 1.2rem;
        }

        .nav-btn span {
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* ========== MODALS ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal {
            background: var(--darker-bg);
            border-radius: var(--radius);
            padding: 1.5rem;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: var(--shadow);
            border: 1px solid rgba(230, 0, 18, 0.3);
        }

        .modal h3 {
            margin-bottom: 1rem;
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .modal p {
            color: var(--text-gray);
            margin-bottom: 1.5rem;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            margin-top: 1.5rem;
        }

        .donate-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            text-decoration: none;
            color: var(--text-light);
            transition: var(--transition);
        }

        .donate-option:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .donate-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .paypal { background: #003087; color: white; }
        .kofi { background: #FF5E5B; color: white; }

        /* ========== RESPONSIVE DESIGN ========== */
        @media (max-width: 1024px) {
            .sidebar {
                position: fixed;
                top: 70px;
                left: -400px;
                width: 350px;
                height: calc(100vh - 70px);
                z-index: 999;
                box-shadow: 5px 0 20px rgba(0, 0, 0, 0.3);
                transition: var(--transition);
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .mobile-filters,
            .mobile-controls,
            .mobile-bottom-nav {
                display: flex;
            }
            
            .header-text p {
                display: block;
            }
            
            .header-actions {
                display: none;
            }
            
            .mobile-header-actions {
                display: flex;
                gap: 0.5rem;
            }
        }

        @media (min-width: 1025px) {
            .sidebar {
                display: flex;
            }
            
            .mobile-header-actions {
                display: none;
            }
        }

        /* ========== LANGUAGE SELECTOR MOBILE ========== */
        .mobile-header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* ========== LOADING STATES ========== */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            font-size: 1.2rem;
            color: var(--text-gray);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(230, 0, 18, 0.3);
            border-top-color: var(--primary-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========== CUSTOM SCROLLBAR ========== */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-red);
            border-radius: 10px;
        }

        /* ========== OVERLAY ========== */
        .overlay-backdrop {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 998;
            display: none;
        }

        .overlay-backdrop.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <div class="logo">M</div>
            <div class="header-text">
                <h1>Japan Explorer Pro</h1>
                <p>@Muchan_official ‚Ä¢ 1000+ spots</p>
            </div>
        </div>
        
        <div class="header-actions">
            <select class="language-selector" id="languageSelect">
                <option value="en">üá¨üáß English</option>
                <option value="nl">üá≥üá± Dutch</option>
                <option value="de">üá©üá™ German</option>
                <option value="es">üá™üá∏ Spanish</option>
                <option value="tr">üáπüá∑ Turkish</option>
                <option value="ja">üáØüáµ Japanese</option>
            </select>
            <button class="donate-btn" id="donateBtn">
                <i class="fas fa-heart"></i> Donate
            </button>
            <a href="https://www.youtube.com/@Muchan94" target="_blank" class="youtube-badge">
                <i class="fab fa-youtube"></i> YouTube
            </a>
            <a href="https://www.tiktok.com/@muchan_official?_r=1&_t=ZG-91sf9Jp4d0L" target="_blank" class="tiktok-badge">
                <i class="fab fa-tiktok"></i> TikTok
            </a>
        </div>
        
        <div class="mobile-header-actions">
            <select class="language-selector" id="mobileLanguageSelect">
                <option value="en">EN</option>
                <option value="nl">NL</option>
                <option value="de">DE</option>
                <option value="es">ES</option>
                <option value="tr">TR</option>
                <option value="ja">JP</option>
            </select>
            <button class="donate-btn" id="mobileDonateBtn">
                <i class="fas fa-heart"></i>
            </button>
        </div>
    </header>

    <!-- Mobile Filters -->
    <div class="mobile-filters" id="mobileFilters">
        <div class="filter-chips">
            <button class="filter-chip active" data-category="all">All</button>
            <button class="filter-chip" data-category="pokemon">Pok√©mon</button>
            <button class="filter-chip" data-category="food">Food</button>
            <button class="filter-chip" data-category="matcha">Matcha</button>
            <button class="filter-chip" data-category="mochi">Mochi</button>
            <button class="filter-chip" data-category="ramen">Ramen</button>
            <button class="filter-chip" data-category="streetfood">Street Food</button>
            <button class="filter-chip" data-category="teamlab">TeamLab</button>
            <button class="filter-chip" data-category="onsen">Onsen</button>
            <button class="filter-chip" data-category="shopping">Shopping</button>
            <button class="filter-chip" data-category="culture">Culture</button>
            <button class="filter-chip" data-category="sweets">Sweets</button>
            <button class="filter-chip" data-category="anime">Anime</button>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchBox" class="search-box" placeholder="Search 1000+ spots in Japan...">
                </div>
            </div>

            <div class="filters-section">
                <h3><i class="fas fa-filter"></i> Filter by Category</h3>
                <div class="filter-row">
                    <button class="filter-btn active" data-category="all">All Spots</button>
                    <button class="filter-btn" data-category="pokemon">Pok√©mon</button>
                    <button class="filter-btn" data-category="food">Food</button>
                    <button class="filter-btn" data-category="matcha">Matcha</button>
                    <button class="filter-btn" data-category="mochi">Mochi</button>
                </div>
                <div class="filter-row">
                    <button class="filter-btn" data-category="ramen">Ramen</button>
                    <button class="filter-btn" data-category="streetfood">Street Food</button>
                    <button class="filter-btn" data-category="teamlab">TeamLab</button>
                    <button class="filter-btn" data-category="onsen">Onsen</button>
                    <button class="filter-btn" data-category="shopping">Shopping</button>
                </div>
                <div class="filter-row">
                    <button class="filter-btn" data-category="culture">Culture</button>
                    <button class="filter-btn" data-category="sweets">Sweets</button>
                    <button class="filter-btn" data-category="anime">Anime</button>
                </div>

                <h3 style="margin-top: 1.5rem;"><i class="fas fa-map-marker-alt"></i> Filter by Region</h3>
                <select id="regionFilter" class="region-select">
                    <option value="">All Regions</option>
                    <option value="tokyo">Tokyo Area</option>
                    <option value="kansai">Kansai (Osaka/Kyoto)</option>
                    <option value="hokkaido">Hokkaido</option>
                    <option value="chubu">Chubu (Nagoya)</option>
                    <option value="chugoku">Chugoku (Hiroshima)</option>
                    <option value="shikoku">Shikoku</option>
                    <option value="kyushu">Kyushu</option>
                    <option value="okinawa">Okinawa</option>
                </select>

                <div class="filter-actions">
                    <button class="action-btn secondary" id="clearFilters">
                        <i class="fas fa-undo"></i> Clear
                    </button>
                    <button class="action-btn primary" id="applyFilters">
                        <i class="fas fa-check"></i> Apply
                    </button>
                </div>
            </div>

            <div class="places-list">
                <div class="places-header">
                    <h3><i class="fas fa-map-marker-alt"></i> Discover Japan</h3>
                    <span id="placesCount" class="places-count">Loading...</span>
                </div>
                <div id="placesContainer">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        Loading 1000+ Japan spots...
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Container -->
        <div class="map-container">
            <div id="map"></div>
            
            <!-- Overlay Backdrop -->
            <div class="overlay-backdrop" id="overlayBackdrop"></div>
            
            <!-- Map Controls -->
            <div class="mobile-controls" id="mobileControls">
                <button class="control-btn" id="toggleSidebar" title="Toggle sidebar">
                    <i class="fas fa-list"></i>
                </button>
                <button class="control-btn" id="locateMe" title="Locate me">
                    <i class="fas fa-location-crosshairs"></i>
                </button>
                <button class="control-btn" id="zoomIn" title="Zoom in">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="control-btn" id="zoomOut" title="Zoom out">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="control-btn" id="fitMarkers" title="Show all">
                    <i class="fas fa-globe-asia"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Google Street View Modal -->
    <div class="streetview-modal" id="streetviewModal">
        <div class="streetview-content">
            <button class="close-streetview" id="closeStreetview">
                <i class="fas fa-times"></i>
            </button>
            <iframe id="streetviewIframe" class="streetview-iframe" 
                    allowfullscreen
                    loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade">
            </iframe>
            <div class="streetview-info">
                <h3 id="streetviewTitle"></h3>
                <p id="streetviewDescription"></p>
                <p style="color: var(--accent-green); font-size: 0.9rem;">
                    <i class="fas fa-info-circle"></i> Drag to look around ‚Ä¢ Scroll to zoom ‚Ä¢ Click arrows to move
                </p>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav" id="mobileNav">
        <button class="nav-btn active" id="navMap">
            <i class="fas fa-map"></i>
            <span>Map</span>
        </button>
        <button class="nav-btn" id="navSearch">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </button>
        <button class="nav-btn" id="navFilters">
            <i class="fas fa-filter"></i>
            <span>Filters</span>
        </button>
        <button class="nav-btn" id="navFavorites">
            <i class="fas fa-heart"></i>
            <span>Saved</span>
        </button>
        <button class="nav-btn" id="navMenu">
            <i class="fas fa-bars"></i>
            <span>Menu</span>
        </button>
    </nav>

    <!-- Donate Modal -->
    <div class="modal-overlay" id="donateModal">
        <div class="modal">
            <h3><i class="fas fa-heart"></i> Support @Muchan_official</h3>
            <p>This interactive Japan map with 1000+ spots is completely free! If you find it helpful and want to support my work, you can donate via:</p>
            
            <div class="modal-buttons">
                <a href="https://paypal.me/muchanofficial" target="_blank" class="donate-option">
                    <div class="donate-icon paypal">
                        <i class="fab fa-paypal"></i>
                    </div>
                    <div>
                        <strong>PayPal</strong>
                        <div style="font-size: 0.85rem; color: var(--text-gray);">One-time donation</div>
                    </div>
                </a>
                
                <a href="https://ko-fi.com/muchan_official" target="_blank" class="donate-option">
                    <div class="donate-icon kofi">
                        <i class="fas fa-mug-hot"></i>
                    </div>
                    <div>
                        <strong>Ko-fi</strong>
                        <div style="font-size: 0.85rem; color: var(--text-gray);">Monthly support</div>
                    </div>
                </a>
            </div>
            
            <p style="margin-top: 1.5rem; font-size: 0.85rem; color: var(--text-gray); text-align: center;">
                <i class="fas fa-star"></i> Follow me on TikTok & YouTube for more Japan content!
            </p>
            
            <div style="display: flex; gap: 1rem; margin-top: 1rem; justify-content: center;">
                <a href="https://www.tiktok.com/@muchan_official" target="_blank" class="tiktok-badge" style="font-size: 0.8rem;">
                    <i class="fab fa-tiktok"></i> TikTok
                </a>
                <a href="https://www.youtube.com/@Muchan94" target="_blank" class="youtube-badge" style="font-size: 0.8rem;">
                    <i class="fab fa-youtube"></i> YouTube
                </a>
            </div>
            
            <button class="action-btn primary" id="closeDonateModal" style="width: 100%; margin-top: 1.5rem;">
                Continue Exploring
            </button>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal-overlay" id="shareModal">
        <div class="modal">
            <h3><i class="fas fa-share-alt"></i> Share Japan Explorer</h3>
            <p>Share this interactive map with your friends who are visiting Japan!</p>
            <div class="modal-buttons">
                <button class="action-btn primary" onclick="shareTo('whatsapp')" style="background: #25D366;">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </button>
                <button class="action-btn primary" onclick="shareTo('tiktok')" style="background: #000;">
                    <i class="fab fa-tiktok"></i> TikTok
                </button>
                <button class="action-btn primary" onclick="shareTo('telegram')" style="background: #0088cc;">
                    <i class="fab fa-telegram"></i> Telegram
                </button>
                <button class="action-btn secondary" id="closeShareModal">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // ========== INITIALIZATION ==========
        let map;
        let markers = [];
        let activePlaceId = null;
        let currentLanguage = 'en';
        let currentCategory = 'all';
        let currentRegion = '';
        let placesData = [];

        // ========== MULTI-LANGUAGE SUPPORT ==========
        const translations = {
            en: {
                searchPlaceholder: "Search 1000+ spots in Japan...",
                allSpots: "All Spots",
                discoverJapan: "Discover Japan",
                filterByCategory: "Filter by Category",
                filterByRegion: "Filter by Region",
                allRegions: "All Regions",
                tokyoArea: "Tokyo Area",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Clear",
                apply: "Apply",
                directions: "Directions",
                streetView: "Street View",
                share: "Share",
                loading: "Loading 1000+ Japan spots...",
                noResults: "No places found",
                viewStreetView: "View Street Level",
                googleMaps: "Google Maps",
                loadingImage: "Loading street view..."
            },
            nl: {
                searchPlaceholder: "Zoek 1000+ plekken in Japan...",
                allSpots: "Alle Plekken",
                discoverJapan: "Ontdek Japan",
                filterByCategory: "Filter op Categorie",
                filterByRegion: "Filter op Regio",
                allRegions: "Alle Regio's",
                tokyoArea: "Tokyo Gebied",
                kansai: "Kansai (Osaka/Kyoto)",
                hokkaido: "Hokkaido",
                chubu: "Chubu (Nagoya)",
                chugoku: "Chugoku (Hiroshima)",
                shikoku: "Shikoku",
                kyushu: "Kyushu",
                okinawa: "Okinawa",
                clear: "Wissen",
                apply: "Toepassen",
                directions: "Route",
                streetView: "Street View",
                share: "Delen",
                loading: "1000+ Japan plekken laden...",
                noResults: "Geen plekken gevonden",
                viewStreetView: "Straatniveau bekijken",
                googleMaps: "Google Maps",
                loadingImage: "Straatbeeld laden..."
            },
            ja: {
                searchPlaceholder: "Êó•Êú¨„ÅÆ1000‰ª•‰∏ä„ÅÆ„Çπ„Éù„ÉÉ„Éà„ÇíÊ§úÁ¥¢...",
                allSpots: "„Åô„Åπ„Å¶„ÅÆ„Çπ„Éù„ÉÉ„Éà",
                discoverJapan: "Êó•Êú¨„ÇíÁô∫Ë¶ã",
                filterByCategory: "„Ç´„ÉÜ„Ç¥„É™„Éº„Åß„Éï„Ç£„É´„Çø„Éº",
                filterByRegion: "Âú∞Âüü„Åß„Éï„Ç£„É´„Çø„Éº",
                allRegions: "„Åô„Åπ„Å¶„ÅÆÂú∞Âüü",
                tokyoArea: "Êù±‰∫¨„Ç®„É™„Ç¢",
                kansai: "Èñ¢Ë•øÔºàÂ§ßÈò™/‰∫¨ÈÉΩÔºâ",
                hokkaido: "ÂåóÊµ∑ÈÅì",
                chubu: "‰∏≠ÈÉ®ÔºàÂêçÂè§Â±ãÔºâ",
                chugoku: "‰∏≠ÂõΩÔºàÂ∫ÉÂ≥∂Ôºâ",
                shikoku: "ÂõõÂõΩ",
                kyushu: "‰πùÂ∑û",
                okinawa: "Ê≤ñÁ∏Ñ",
                clear: "„ÇØ„É™„Ç¢",
                apply: "ÈÅ©Áî®",
                directions: "„É´„Éº„Éà",
                streetView: "„Çπ„Éà„É™„Éº„Éà„Éì„É•„Éº",
                share: "ÂÖ±Êúâ",
                loading: "1000‰ª•‰∏ä„ÅÆÊó•Êú¨„Çπ„Éù„ÉÉ„Éà„ÇíË™≠„ÅøËæº„Åø‰∏≠...",
                noResults: "Â†¥ÊâÄ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",
                viewStreetView: "„Çπ„Éà„É™„Éº„Éà„É¨„Éô„É´„ÇíË¶ã„Çã",
                googleMaps: "Google„Éû„ÉÉ„Éó",
                loadingImage: "„Çπ„Éà„É™„Éº„Éà„Éì„É•„Éº„ÇíË™≠„ÅøËæº„Åø‰∏≠..."
            }
        };

        // ========== SAMPLE DATA ==========
        const samplePlaces = [
            {
                id: 1,
                name: "Pok√©mon Center Tokyo DX",
                location: "Tokyo, Chiyoda City",
                lat: 35.681236,
                lng: 139.767125,
                description: "The largest Pok√©mon Center in Tokyo with exclusive merchandise and Pikachu parades.",
                category: "pokemon",
                region: "tokyo",
                tags: ["Pok√©mon", "Shopping", "Anime"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=35.681236,139.767125&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 2,
                name: "Tsukiji Outer Market",
                location: "Tokyo, Tsukiji",
                lat: 35.665320,
                lng: 139.769613,
                description: "Famous fish market with the freshest sushi and street food stalls.",
                category: "food",
                region: "tokyo",
                tags: ["Sushi", "Seafood", "Street Food"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=35.665320,139.769613&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 3,
                name: "Fushimi Inari Shrine",
                location: "Kyoto, Fushimi Ward",
                lat: 34.967146,
                lng: 135.772695,
                description: "Famous for its thousands of vermilion torii gates stretching up the mountain.",
                category: "culture",
                region: "kansai",
                tags: ["Shrine", "Hiking", "Photography"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=34.967146,135.772695&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 4,
                name: "Ichiran Ramen",
                location: "Osaka, Namba",
                lat: 34.667481,
                lng: 135.500567,
                description: "Famous tonkotsu ramen chain with individual cubicle seating.",
                category: "ramen",
                region: "kansai",
                tags: ["Ramen", "Noodles", "Fast Food"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=34.667481,135.500567&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 5,
                name: "TeamLab Planets",
                location: "Tokyo, Toyosu",
                lat: 35.645763,
                lng: 139.791574,
                description: "Immersive digital art museum where you walk through water and flower rooms.",
                category: "teamlab",
                region: "tokyo",
                tags: ["Digital Art", "Museum", "Interactive"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=35.645763,139.791574&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 6,
                name: "Nakiryu Ramen",
                location: "Tokyo, Toshima City",
                lat: 35.733772,
                lng: 139.719494,
                description: "Michelin-starred ramen shop famous for its tantanmen noodles.",
                category: "ramen",
                region: "tokyo",
                tags: ["Michelin", "Ramen", "Noodles"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=35.733772,139.719494&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 7,
                name: "Arashiyama Bamboo Grove",
                location: "Kyoto, Ukyo Ward",
                lat: 35.017209,
                lng: 135.672298,
                description: "Stunning bamboo forest pathway that feels like another world.",
                category: "culture",
                region: "kansai",
                tags: ["Bamboo", "Forest", "Nature"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=35.017209,135.672298&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            },
            {
                id: 8,
                name: "Dotonbori Street",
                location: "Osaka, Chuo Ward",
                lat: 34.669585,
                lng: 135.502215,
                description: "Vibrant street famous for its neon signs, street food, and entertainment.",
                category: "streetfood",
                region: "kansai",
                tags: ["Street Food", "Shopping", "Nightlife"],
                streetViewUrl: "https://maps.googleapis.com/maps/api/streetview?size=600x300&location=34.669585,135.502215&fov=90&heading=235&pitch=10&key=DEMO_KEY"
            }
        ];

        // ========== DOM ELEMENTS ==========
        const mapElement = document.getElementById('map');
        const sidebar = document.getElementById('sidebar');
        const overlayBackdrop = document.getElementById('overlayBackdrop');
        const toggleSidebarBtn = document.getElementById('toggleSidebar');
        const searchBox = document.getElementById('searchBox');
        const placesContainer = document.getElementById('placesContainer');
        const placesCount = document.getElementById('placesCount');
        const filterButtons = document.querySelectorAll('.filter-btn, .filter-chip');
        const regionFilter = document.getElementById('regionFilter');
        const applyFiltersBtn = document.getElementById('applyFilters');
        const clearFiltersBtn = document.getElementById('clearFilters');
        const mobileFilters = document.getElementById('mobileFilters');
        const mobileNav = document.getElementById('mobileNav');
        const languageSelect = document.getElementById('languageSelect');
        const mobileLanguageSelect = document.getElementById('mobileLanguageSelect');
        const donateBtn = document.getElementById('donateBtn');
        const mobileDonateBtn = document.getElementById('mobileDonateBtn');
        const donateModal = document.getElementById('donateModal');
        const closeDonateModal = document.getElementById('closeDonateModal');
        const streetviewModal = document.getElementById('streetviewModal');
        const closeStreetview = document.getElementById('closeStreetview');
        const streetviewIframe = document.getElementById('streetviewIframe');
        const streetviewTitle = document.getElementById('streetviewTitle');
        const streetviewDescription = document.getElementById('streetviewDescription');

        // ========== INITIALIZE MAP ==========
        function initMap() {
            map = L.map('map').setView([35.6762, 139.6503], 12); // Tokyo center
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19,
            }).addTo(map);
            
            // Add initial markers
            addMarkersToMap(samplePlaces);
            renderPlacesList(samplePlaces);
            updatePlacesCount(samplePlaces.length);
            
            // Initialize language
            updateLanguage();
        }

        // ========== ADD MARKERS TO MAP ==========
        function addMarkersToMap(places) {
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            // Create icon for each category
            const getIcon = (category) => {
                const iconColors = {
                    pokemon: '#ffcb05',
                    food: '#f59e0b',
                    matcha: '#10b981',
                    mochi: '#8b5cf6',
                    ramen: '#dc2626',
                    streetfood: '#f97316',
                    teamlab: '#3b82f6',
                    onsen: '#06b6d4',
                    shopping: '#ec4899',
                    culture: '#a855f7',
                    sweets: '#ec4899',
                    anime: '#3b82f6'
                };
                
                return L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="background: ${iconColors[category] || '#e60012'}; width: 24px; height: 24px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>`,
                    iconSize: [24, 24],
                    iconAnchor: [12, 12]
                });
            };
            
            // Add new markers
            places.forEach(place => {
                const marker = L.marker([place.lat, place.lng], {
                    icon: getIcon(place.category)
                }).addTo(map);
                
                marker.bindPopup(`
                    <div style="font-family: sans-serif; padding: 0.5rem; max-width: 250px;">
                        <h3 style="margin: 0 0 0.5rem 0; color: #e60012;">${place.name}</h3>
                        <p style="margin: 0 0 0.5rem 0; color: #666; font-size: 0.9rem;">${place.location}</p>
                        <p style="margin: 0 0 0.5rem 0; color: #333;">${place.description}</p>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="openStreetView(${place.lat}, ${place.lng}, '${place.name}', '${place.description}')" style="background: #3b82f6; color: white; border: none; padding: 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">
                                <i class="fas fa-street-view"></i> Street View
                            </button>
                            <a href="https://www.google.com/maps/dir/?api=1&destination=${place.lat},${place.lng}" target="_blank" style="background: #10b981; color: white; border: none; padding: 0.5rem; border-radius: 4px; cursor: pointer; font-size: 0.9rem; text-decoration: none;">
                                <i class="fas fa-directions"></i> Directions
                            </a>
                        </div>
                    </div>
                `);
                
                marker.placeId = place.id;
                markers.push(marker);
                
                // Add click event to center map and show popup
                marker.on('click', () => {
                    map.setView([place.lat, place.lng], 15);
                    highlightPlaceCard(place.id);
                });
            });
        }

        // ========== RENDER PLACES LIST ==========
        function renderPlacesList(places) {
            if (places.length === 0) {
                placesContainer.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-gray);">
                        <i class="fas fa-map-marker-alt" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <h3>No places found</h3>
                        <p>Try changing your filters</p>
                    </div>
                `;
                return;
            }
            
            const placesHtml = places.map(place => {
                const categoryBadgeClass = `${place.category}-badge`;
                return `
                    <div class="place-card" data-id="${place.id}" onclick="selectPlace(${place.id})">
                        <div class="place-category ${categoryBadgeClass}">
                            ${place.category.charAt(0).toUpperCase() + place.category.slice(1)}
                        </div>
                        <h3>${place.name}</h3>
                        <div class="place-location">
                            <i class="fas fa-map-marker-alt"></i> ${place.location}
                        </div>
                        <div class="place-description">${place.description}</div>
                        
                        <!-- Google Street View Thumbnail -->
                        <div class="streetview-thumbnail" onclick="openStreetView(${place.lat}, ${place.lng}, '${place.name}', '${place.description}')">
                            <div class="loading">${translations[currentLanguage].loadingImage}</div>
                            <img src="https://maps.googleapis.com/maps/api/streetview?size=600x300&location=${place.lat},${place.lng}&fov=90&heading=235&pitch=10&key=DEMO_KEY" 
                                 alt="${place.name} Street View" 
                                 style="display: none;"
                                 onload="this.style.display='block'; this.previousElementSibling.style.display='none';"
                                 onerror="this.previousElementSibling.textContent='Street view unavailable';">
                            <div class="streetview-label">
                                <i class="fas fa-street-view"></i> ${translations[currentLanguage].viewStreetView}
                            </div>
                        </div>
                        
                        <div class="place-tags">
                            ${place.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                        <div class="place-actions">
                            <button class="place-action-btn directions-btn" onclick="event.stopPropagation(); openDirections(${place.lat}, ${place.lng})">
                                <i class="fas fa-directions"></i> ${translations[currentLanguage].directions}
                            </button>
                            <button class="place-action-btn streetview-btn" onclick="event.stopPropagation(); openStreetView(${place.lat}, ${place.lng}, '${place.name}', '${place.description}')">
                                <i class="fas fa-street-view"></i> ${translations[currentLanguage].streetView}
                            </button>
                            <button class="place-action-btn" onclick="event.stopPropagation(); sharePlace(${place.id})">
                                <i class="fas fa-share-alt"></i> ${translations[currentLanguage].share}
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            placesContainer.innerHTML = placesHtml;
            
            // Highlight active place if any
            if (activePlaceId) {
                highlightPlaceCard(activePlaceId);
            }
        }

        // ========== HIGHLIGHT PLACE CARD ==========
        function highlightPlaceCard(placeId) {
            // Remove active class from all cards
            document.querySelectorAll('.place-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected card
            const selectedCard = document.querySelector(`.place-card[data-id="${placeId}"]`);
            if (selectedCard) {
                selectedCard.classList.add('active');
                selectedCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            
            // Center map on place
            const place = samplePlaces.find(p => p.id === placeId);
            if (place) {
                map.setView([place.lat, place.lng], 15);
                
                // Open marker popup
                const marker = markers.find(m => m.placeId === placeId);
                if (marker) {
                    marker.openPopup();
                }
            }
            
            activePlaceId = placeId;
        }

        // ========== SELECT PLACE ==========
        function selectPlace(placeId) {
            highlightPlaceCard(placeId);
            
            // On mobile, close sidebar after selection
            if (window.innerWidth <= 1024) {
                sidebar.classList.remove('active');
                overlayBackdrop.classList.remove('active');
            }
        }

        // ========== FILTER PLACES ==========
        function filterPlaces() {
            let filteredPlaces = samplePlaces;
            
            // Filter by category
            if (currentCategory !== 'all') {
                filteredPlaces = filteredPlaces.filter(place => place.category === currentCategory);
            }
            
            // Filter by region
            if (currentRegion) {
                filteredPlaces = filteredPlaces.filter(place => place.region === currentRegion);
            }
            
            // Filter by search
            const searchTerm = searchBox.value.toLowerCase();
            if (searchTerm) {
                filteredPlaces = filteredPlaces.filter(place => 
                    place.name.toLowerCase().includes(searchTerm) ||
                    place.location.toLowerCase().includes(searchTerm) ||
                    place.description.toLowerCase().includes(searchTerm) ||
                    place.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
            }
            
            addMarkersToMap(filteredPlaces);
            renderPlacesList(filteredPlaces);
            updatePlacesCount(filteredPlaces.length);
        }

        // ========== UPDATE PLACES COUNT ==========
        function updatePlacesCount(count) {
            placesCount.textContent = `${count} spots`;
        }

        // ========== OPEN STREET VIEW ==========
        function openStreetView(lat, lng, title, description) {
            streetviewTitle.textContent = title;
            streetviewDescription.textContent = description;
            
            // Use Google Street View Embed API
            streetviewIframe.src = `https://www.google.com/maps/embed/v1/streetview?key=DEMO_KEY&location=${lat},${lng}&heading=210&pitch=10&fov=100`;
            
            streetviewModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // ========== OPEN DIRECTIONS ==========
        function openDirections(lat, lng) {
            window.open(`https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`, '_blank');
        }

        // ========== SHARE PLACE ==========
        function sharePlace(placeId) {
            const place = samplePlaces.find(p => p.id === placeId);
            if (navigator.share) {
                navigator.share({
                    title: `Check out ${place.name} on Japan Explorer`,
                    text: `${place.name} - ${place.description}`,
                    url: window.location.href
                });
            } else {
                // Fallback to modal
                document.getElementById('shareModal').style.display = 'flex';
            }
        }

        // ========== UPDATE LANGUAGE ==========
        function updateLanguage() {
            const lang = currentLanguage;
            
            // Update search placeholder
            searchBox.placeholder = translations[lang].searchPlaceholder;
            
            // Update filter buttons
            document.querySelectorAll('[data-category="all"]').forEach(btn => {
                btn.textContent = translations[lang].allSpots;
            });
            
            // Update region filter options
            const regionOptions = document.querySelectorAll('#regionFilter option');
            regionOptions[0].textContent = translations[lang].allRegions;
            regionOptions[1].textContent = translations[lang].tokyoArea;
            regionOptions[2].textContent = translations[lang].kansai;
            regionOptions[3].textContent = translations[lang].hokkaido;
            regionOptions[4].textContent = translations[lang].chubu;
            regionOptions[5].textContent = translations[lang].chugoku;
            regionOptions[6].textContent = translations[lang].shikoku;
            regionOptions[7].textContent = translations[lang].kyushu;
            regionOptions[8].textContent = translations[lang].okinawa;
            
            // Update UI texts
            document.querySelectorAll('.filters-section h3')[0].innerHTML = `<i class="fas fa-filter"></i> ${translations[lang].filterByCategory}`;
            document.querySelectorAll('.filters-section h3')[1].innerHTML = `<i class="fas fa-map-marker-alt"></i> ${translations[lang].filterByRegion}`;
            document.querySelector('.places-header h3').innerHTML = `<i class="fas fa-map-marker-alt"></i> ${translations[lang].discoverJapan}`;
            
            // Update button texts
            document.getElementById('clearFilters').innerHTML = `<i class="fas fa-undo"></i> ${translations[lang].clear}`;
            document.getElementById('applyFilters').innerHTML = `<i class="fas fa-check"></i> ${translations[lang].apply}`;
            
            // Re-render places list to update action buttons
            filterPlaces();
        }

        // ========== EVENT LISTENERS ==========
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            
            // Toggle sidebar
            toggleSidebarBtn.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                overlayBackdrop.classList.toggle('active');
            });
            
            // Close sidebar when clicking overlay
            overlayBackdrop.addEventListener('click', () => {
                sidebar.classList.remove('active');
                overlayBackdrop.classList.remove('active');
            });
            
            // Search functionality
            searchBox.addEventListener('input', filterPlaces);
            
            // Filter buttons
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    currentCategory = button.dataset.category;
                    filterPlaces();
                });
            });
            
            // Region filter
            regionFilter.addEventListener('change', () => {
                currentRegion = regionFilter.value;
                filterPlaces();
            });
            
            // Apply filters button
            applyFiltersBtn.addEventListener('click', filterPlaces);
            
            // Clear filters button
            clearFiltersBtn.addEventListener('click', () => {
                currentCategory = 'all';
                currentRegion = '';
                regionFilter.value = '';
                searchBox.value = '';
                
                filterButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.category === 'all') {
                        btn.classList.add('active');
                    }
                });
                
                filterPlaces();
            });
            
            // Language selector
            languageSelect.addEventListener('change', (e) => {
                currentLanguage = e.target.value;
                updateLanguage();
            });
            
            mobileLanguageSelect.addEventListener('change', (e) => {
                currentLanguage = e.target.value;
                updateLanguage();
            });
            
            // Donate modal
            donateBtn.addEventListener('click', () => {
                donateModal.style.display = 'flex';
            });
            
            mobileDonateBtn.addEventListener('click', () => {
                donateModal.style.display = 'flex';
            });
            
            closeDonateModal.addEventListener('click', () => {
                donateModal.style.display = 'none';
            });
            
            donateModal.addEventListener('click', (e) => {
                if (e.target === donateModal) {
                    donateModal.style.display = 'none';
                }
            });
            
            // Street view modal
            closeStreetview.addEventListener('click', () => {
                streetviewModal.style.display = 'none';
                streetviewIframe.src = '';
                document.body.style.overflow = 'auto';
            });
            
            streetviewModal.addEventListener('click', (e) => {
                if (e.target === streetviewModal) {
                    streetviewModal.style.display = 'none';
                    streetviewIframe.src = '';
                    document.body.style.overflow = 'auto';
                }
            });
            
            // Mobile navigation
            document.getElementById('navSearch').addEventListener('click', () => {
                sidebar.classList.add('active');
                overlayBackdrop.classList.add('active');
                searchBox.focus();
            });
            
            document.getElementById('navFilters').addEventListener('click', () => {
                sidebar.classList.add('active');
                overlayBackdrop.classList.add('active');
            });
            
            // Map controls
            document.getElementById('locateMe').addEventListener('click', () => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(position => {
                        map.setView([position.coords.latitude, position.coords.longitude], 15);
                    });
                }
            });
            
            document.getElementById('zoomIn').addEventListener('click', () => {
                map.zoomIn();
            });
            
            document.getElementById('zoomOut').addEventListener('click', () => {
                map.zoomOut();
            });
            
            document.getElementById('fitMarkers').addEventListener('click', () => {
                if (markers.length > 0) {
                    const group = new L.featureGroup(markers);
                    map.fitBounds(group.getBounds());
                }
            });
            
            // Close share modal
            document.getElementById('closeShareModal').addEventListener('click', () => {
                document.getElementById('shareModal').style.display = 'none';
            });
            
            // Share functions
            window.shareTo = (platform) => {
                const url = encodeURIComponent(window.location.href);
                const text = encodeURIComponent("Check out Japan Explorer Pro - Interactive map with 1000+ spots in Japan!");
                
                let shareUrl = '';
                switch(platform) {
                    case 'whatsapp':
                        shareUrl = `https://wa.me/?text=${text}%20${url}`;
                        break;
                    case 'tiktok':
                        // TikTok doesn't have a direct share URL, use copy to clipboard
                        navigator.clipboard.writeText(window.location.href);
                        alert('Link copied to clipboard! Share it on TikTok.');
                        return;
                    case 'telegram':
                        shareUrl = `https://t.me/share/url?url=${url}&text=${text}`;
                        break;
                }
                
                window.open(shareUrl, '_blank');
                document.getElementById('shareModal').style.display = 'none';
            };
            
            // Responsive behavior
            window.addEventListener('resize', () => {
                if (window.innerWidth > 1024) {
                    sidebar.classList.remove('active');
                    overlayBackdrop.classList.remove('active');
                }
            });
        });

        // ========== EXPORT FUNCTIONS FOR HTML ONCLICK ==========
        window.selectPlace = selectPlace;
        window.openStreetView = openStreetView;
        window.openDirections = openDirections;
        window.sharePlace = sharePlace;
    </script>
</body>
</html>
